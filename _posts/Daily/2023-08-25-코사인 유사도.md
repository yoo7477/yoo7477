---
title : "코사인 유사도"
categories :
- DAILY
tag : [MATH, ML]
toc: true
toc_sticky: true
toc_label : "목록"
author_profile : false
search: true
use_math: true
---
<br/>

# 코사인 유사도(Cosine Similarity)


## 1. 개념  
벡터와 벡터간 유사도를 비교할 때 벡터의 크기보다 벡터의 패턴(방향)이 얼마나 유사한지 측정하는 척도임.

## 2. 사용하는 이유
좌표평면 상에 벡터로 표현된 두 데이터 $\mathbf{a}=(a_1, a_2), \mathbf{b}=(b_1, b_2)$가 아래 그림과 같은 형태라고 할 때 $\mathbf{a}$ 와 $\mathbf{b}$의 패턴(방향)은 유사하지만 벡터 간의 거리는 매우 크게 되어 거리 척도(Euclidean, Manhattan distance 등)를 활용해서는 $\mathbf{a}$와 $\mathbf{b}$가 관계 없다고 나타나기 때문에 개념에서 설명했던 것처럼 두 데이터의 패턴(방향)에 관심 있을 때 활용함.

![정의](../../assets/images/post_images/2023-08-25-(01)/figure1.png){: .align-center  width="30%" height="30%"}

## 3. 측정방법
두 벡터사이의 사잇각($\theta$)을 구해서 $\theta$가 작으면 데이터의 유사도가 높고 $\theta$가 크면 유사도가 낮다고 판단할 수 있음. 사잇각은 벡터의 내적(Inner product)로부터 정의되므로 $\theta$를 직접 계산하기 보다는 벡터의 내적을 이용해 $\theta$의 코사인 값으로 유사도를 측정함.


### 3.1 내적의 성질
a. $\mathbf{a \cdot a}$ = $\parallel\mathbf{a}\parallel^2>=0$, $\mathbf{a \cdot a}$ $\Leftrightarrow$ **a**=0   
b. $a \cdot b = b\cdot a$(교환법칙)  
c. $(a+b)\cdot c = ac+bc$(분배법칙)  
d. $(ka)\cdot b = a\cdot (kb) = k\cdot(ab)$

### 3.2 사잇각 계산
벡터의 내적은 두 벡터가 이루는 사잇각과 관련 있고, 아래 그림에서 피타고라스 정리를 통해 알 수 있음.

![정의](../../assets/images/post_images/2023-08-25-(01)/figure2.png){: .align-center  width="30%" height="30%"}

이를 벡터를 이용해 다시 표현하고, 내적의 성질에 의해 아래와 같은 수식이 나오고
<center>

- $\parallel\mathbf{a-b}\parallel^2$ = $\parallel\mathbf{a}\parallel^2$ + $\parallel\mathbf{b}\parallel^2 -2\parallel\mathbf{a}\parallel\parallel\mathbf{b}\parallel\cos(\theta)$ 
- $\parallel\mathbf{a-b}\parallel^2$ = $(\mathbf{a-b})\cdot(\mathbf{a-b})$  = $\mathbf{a}\cdot\mathbf{a}$ - $\mathbf{a}\cdot\mathbf{b}$ - $\mathbf{b}\cdot\mathbf{a}$ + $\mathbf{b}\cdot\mathbf{b}$ = $\parallel\mathbf{a}^2\parallel$ +$\parallel\mathbf{b}^2\parallel$ $-2(\mathbf{a}\cdot\mathbf{b})$  
</center>
두 식을 비교하면 다음을 얻을 수 있음.  
<center>

$\cos(\theta)$ = $\frac{\mathbf{a\cdot b}}{\parallel\mathbf{a}\parallel\mathbf{b}\parallel}$
</center>

## 4. 코사인 유사도 계산 
두 데이터 $\mathbf{a}=(a_1, a_2)$와 $\mathbf{b}=(b_1, b_2)$의 코사인 유사도는   
 <center> 
 cos$\theta$ = $\frac{\mathbf{a}\cdot {\mathbf{b}}}{\parallel\mathbf{a}\parallel \parallel \mathbf{b}\parallel}$ = $\frac{\sum(\mathbf{ab})}{\sqrt{\sum\mathbf{a_i^2}} \cdot \sqrt{\sum\mathbf{b_i^2}}}$   
 </center> 

$n$차원 공간 $\mathbb{R}^n$의 두 벡터 $\mathbf{a}=(a_1, a_2,\cdots,a_n),\mathbf{b}=(b_1,b_2,\cdots,b_n)$에 대해서도 동일하게 성립된다. 